# FMO Mobile Controller

FMO Mobile Controller 是一个专为移动端设计的单文件 HTML5 控制器，用于远程控制 FMO 并实时收听/可视化音频流。它采用响应式设计，适配手机、平板和桌面浏览器。

## ✨ 主要功能

*   **零依赖单文件**：所有逻辑（HTML/CSS/JS）集成在一个 `.html` 文件中，部署和使用极度便捷。
*   **响应式布局**：
    *   **移动端**：垂直堆叠布局，优化触摸操作。
    *   **平板/桌面**：自适应网格布局，可视化与控制面板分栏显示。
*   **实时音频流**：基于 Web Audio API 和 WebSocket 接收 PCM 音频流，低延迟播放。
*   **炫酷可视化**：内置高性能 Canvas 音频可视化引擎，支持 6 种模式：
    *   Spectrum (频谱图)
    *   Mirror (镜像频谱)
    *   Waveform (波形图)
    *   Oscilloscope (示波器)
    *   Radial (径向频谱)
    *   Particles (粒子效果)
*   **多主题支持**：内置 5 套精美主题，支持一键切换（默认为橙色暗黑风格）。
*   **远程控制**：
    *   服务器连接管理（支持历史记录、自动重连）。
    *   台站切换与列表自动刷新（10秒轮询）。
    *   音量控制（触摸优化滑块）。
    *   录音功能（支持导出 WAV）。
*   **QSO 日志查看**：内置模态框查看服务器端的通联日志记录。

## 🚀 快速开始

1.  **打开控制器**：直接在浏览器中打开 `fmo-mobile-controller.html` 文件。
2.  **连接服务器**：
    *   点击右上角的 **设置图标** (⚙️) 展开设置面板。
    *   在输入框中输入 FMO 服务器的 IP 地址（例如 `192.168.1.100`）。
    *   点击 **CONNECT** 按钮。
3.  **开始使用**：连接成功后，状态指示灯将变绿，您可以开始播放音频、切换台站或查看可视化效果。

## 📱 界面指南

### 顶部导航栏
*   **Logo**：显示应用名称。
*   **功能按钮**：
    *   📝 **QSO 日志**：点击查看服务器记录的通联日志。
    *   ⚙️ **设置**：展开/收起连接设置面板。
    *   🎨 **主题**：循环切换界面主题风格。
*   **状态指示灯**：
    *   左侧圆点：控制信令 (WebSocket) 连接状态。
    *   右侧圆点：音频流 (Audio) 连接状态。

### 可视化区域
*   点击可视化画布区域可循环切换 **6 种显示模式**。
*   右上角标签显示当前模式名称。

### 控制面板
*   **播放/暂停**：控制音频流的连接与断开。
*   **录音**：点击开始录制当前音频，再次点击停止并下载 WAV 文件。
*   **音量**：拖动滑块或点击图标静音。
*   **台站列表**：显示当前可用台站，支持点击切换。列表每 10 秒自动刷新。

## 🛠 技术架构

本项目完全基于原生 Web 技术构建，无构建步骤：

*   **核心类设计**：
    *   `ControlClient`: 处理 WebSocket 信令通信、自动重连、心跳保活。
    *   `AudioPlayer`: 管理 Web Audio Context、PCM 流解码、缓冲调度、录音。
    *   `Visualizer`: 基于 `requestAnimationFrame` 的 Canvas 绘图引擎。
    *   `VolumeSlider`: 自定义触摸友好的音量控件逻辑。
    *   `DeviceManager`: 基于 `localStorage` 管理设备连接历史。
    *   `QsoManager`: 管理 QSO 日志数据的获取与弹窗渲染。
*   **样式系统**：
    *   CSS Variables (`:root`) 实现动态主题切换。
    *   CSS Grid & Flexbox 实现响应式布局。
    *   针对 iOS 安全区域 (`safe-area-inset`) 进行了适配。

## 📋 浏览器兼容性

需要支持以下特性的现代浏览器：
*   WebSocket API
*   Web Audio API
*   ES6 Classes & Modules

推荐使用 Chrome (Android/Desktop) 或 Safari (iOS)。
