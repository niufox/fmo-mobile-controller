# FMO Mobile Controller - ä»£ç åˆ†ç¦»ç‰ˆæœ¬

## ğŸ“ é¡¹ç›®ç»“æ„

```
wwwroot/
â”œâ”€â”€ index.html                 # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ css/                       # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ base.css              # åŸºç¡€æ ·å¼ï¼ˆCSSå˜é‡ã€é‡ç½®ã€bodyï¼‰
â”‚   â”œâ”€â”€ themes.css            # ä¸»é¢˜æ ·å¼
â”‚   â”œâ”€â”€ components.css        # ç»„ä»¶æ ·å¼
â”‚   â””â”€â”€ main.css              # ä¸»æ ·å¼æ–‡ä»¶ï¼ˆå¯¼å…¥å…¶ä»–CSSï¼‰
â”œâ”€â”€ js/                        # JavaScriptæ–‡ä»¶
â”‚   â”œâ”€â”€ main.js               # ä¸»å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ core/                 # æ ¸å¿ƒå·¥å…·
â”‚   â”‚   â”œâ”€â”€ EventEmitter.js    # äº‹ä»¶å‘å°„å™¨åŸºç±»
â”‚   â”‚   â””â”€â”€ utils.js           # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ audio/                # éŸ³é¢‘ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ AudioPlayer.js     # éŸ³é¢‘æ’­æ”¾å™¨
â”‚   â”‚   â”œâ”€â”€ VolumeSlider.js     # éŸ³é‡æ§åˆ¶
â”‚   â”‚   â”œâ”€â”€ Visualizer.js       # å¯è§†åŒ–å¼•æ“
â”‚   â”‚   â””â”€â”€ renderers/         # å¯è§†åŒ–æ¸²æŸ“å™¨
â”‚   â”‚       â”œâ”€â”€ BaseRenderer.js
â”‚   â”‚       â”œâ”€â”€ SpectrumRenderer.js
â”‚   â”‚       â”œâ”€â”€ MirrorRenderer.js
â”‚   â”‚       â”œâ”€â”€ WaveformRenderer.js
â”‚   â”‚       â”œâ”€â”€ OscilloscopeRenderer.js
â”‚   â”‚       â”œâ”€â”€ RadialRenderer.js
â”‚   â”‚       â”œâ”€â”€ ParticlesRenderer.js
â”‚   â”‚       â””â”€â”€ SolarSystemRenderer.js
â”‚   â”œâ”€â”€ network/              # ç½‘ç»œç›¸å…³
â”‚   â”‚   â”œâ”€â”€ ControlClient.js    # WebSocketæ§åˆ¶å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ EventsClient.js    # WebSocketäº‹ä»¶å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ DiscoveryManager.js # è®¾å¤‡å‘ç°ç®¡ç†
â”‚   â”‚   â””â”€â”€ DeviceManager.js    # è®¾å¤‡å†å²ç®¡ç†
â”‚   â””â”€â”€ ...                   # å…¶ä»–æ¨¡å—
â”‚       â”œâ”€â”€ QsoManager.js       # QSOæ—¥å¿—ç®¡ç†
â”‚       â”œâ”€â”€ SpeechTranscriber.js # è¯­éŸ³è½¬å½•
â”‚       â””â”€â”€ CallsignTicker.js   # å‘¼å·æ˜¾ç¤º
â””â”€â”€ assets/                    # é™æ€èµ„æº
    â””â”€â”€ map.html               # QSOåœ°å›¾
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¼€å‘ç¯å¢ƒ

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd wwwroot

# ä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨è¿è¡Œï¼ˆæ¨èï¼‰
python3 -m http.server 8000
# æˆ–
npx serve .
# æˆ–
php -S localhost:8000
```

ç„¶ååœ¨æµè§ˆå™¨ä¸­è®¿é—® `http://localhost:8000`

### 2. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

ç›´æ¥å°† `wwwroot` ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ¨ç½²åˆ°WebæœåŠ¡å™¨å³å¯ã€‚

## ğŸ“¦ æ–‡ä»¶è¯´æ˜

### HTMLæ–‡ä»¶

- **index.html**: ä¸»é¡µé¢ï¼ŒåŒ…å«HTMLç»“æ„å’Œèµ„æºå¼•ç”¨

### CSSæ–‡ä»¶

- **base.css**: CSSå˜é‡ã€é‡ç½®æ ·å¼ã€bodyåŸºç¡€æ ·å¼
- **themes.css**: æ‰€æœ‰9ä¸ªä¸»é¢˜çš„æ ·å¼å®šä¹‰
- **components.css**: æ‰€æœ‰UIç»„ä»¶çš„æ ·å¼
- **main.css**: ä¸»æ ·å¼æ–‡ä»¶ï¼Œä½¿ç”¨@importå¯¼å…¥å…¶ä»–CSSæ–‡ä»¶

### JavaScriptæ–‡ä»¶

#### æ ¸å¿ƒæ¨¡å— (js/core/)

- **EventEmitter.js**: äº‹ä»¶å‘å°„å™¨åŸºç±»ï¼Œæ‰€æœ‰æ”¯æŒäº‹ä»¶çš„ç±»éƒ½ç»§æ‰¿è‡ªæ­¤ç±»
- **utils.js**: å·¥å…·å‡½æ•°åº“
  - `debounce(fn, delay)`: é˜²æŠ–å‡½æ•°
  - `throttle(fn, limit)`: èŠ‚æµå‡½æ•°
  - `showError(message, error)`: é”™è¯¯æç¤º
  - `safeJSONParse(str, fallback)`: å®‰å…¨JSONè§£æ
  - `isOnline()`: ç½‘ç»œçŠ¶æ€æ£€æŸ¥

#### éŸ³é¢‘æ¨¡å— (js/audio/)

- **AudioPlayer.js**: PCMéŸ³é¢‘æµæ’­æ”¾å™¨
  - æ”¯æŒWebSocketéŸ³é¢‘æµ
  - éŸ³é¢‘å¤„ç†é“¾ï¼ˆHPFã€LPFã€EQã€å‹ç¼©å™¨ï¼‰
  - å½•éŸ³åŠŸèƒ½
  - æœ¬åœ°é™éŸ³åŠŸèƒ½

- **VolumeSlider.js**: éŸ³é‡æ§åˆ¶ç»„ä»¶
  - é¼ æ ‡æ‹–åŠ¨æ”¯æŒ
  - è§¦æ‘¸æ‹–åŠ¨æ”¯æŒ
  - é™éŸ³åˆ‡æ¢
  - èµ„æºæ¸…ç†

- **Visualizer.js**: å¯è§†åŒ–å¼•æ“
  - 7ç§å¯è§†åŒ–æ¨¡å¼
  - æ€§èƒ½ä¼˜åŒ–
  - ä¸»é¢˜åˆ‡æ¢æ”¯æŒ
  - èµ„æºæ¸…ç†

- **renderers/**: å¯è§†åŒ–æ¸²æŸ“å™¨
  - **BaseRenderer.js**: æ¸²æŸ“å™¨åŸºç±»
  - **SpectrumRenderer.js**: é¢‘è°±å¯è§†åŒ–
  - **MirrorRenderer.js**: é•œåƒå¯è§†åŒ–
  - **WaveformRenderer.js**: æ³¢å½¢å¯è§†åŒ–
  - **OscilloscopeRenderer.js**: ç¤ºæ³¢å™¨å¯è§†åŒ–
  - **RadialRenderer.js**: å¾„å‘å¯è§†åŒ–
  - **ParticlesRenderer.js**: ç²’å­å¯è§†åŒ–
  - **SolarSystemRenderer.js**: å¤ªé˜³ç³»å¯è§†åŒ–

#### ç½‘ç»œæ¨¡å— (js/network/)

- **ControlClient.js**: WebSocketæ§åˆ¶å®¢æˆ·ç«¯
  - å°ç«™åˆ—è¡¨è·å–
  - å°ç«™åˆ‡æ¢
  - è‡ªåŠ¨é‡è¿
  - è‡ªåŠ¨æ›´æ–°

- **EventsClient.js**: WebSocketäº‹ä»¶å®¢æˆ·ç«¯
  - å‘¼å·äº‹ä»¶ç›‘å¬
  - å‘è¨€çŠ¶æ€ç›‘å¬
  - QSOæ—¥å¿—äº‹ä»¶
  - è‡ªåŠ¨é‡è¿

- **DiscoveryManager.js**: mDNSè®¾å¤‡å‘ç°
  - å±€åŸŸç½‘è®¾å¤‡æœç´¢
  - å®æ—¶å‘ç°
  - è®¾å¤‡åˆ—è¡¨ç®¡ç†

- **DeviceManager.js**: è®¾å¤‡å†å²ç®¡ç†
  - è®¾å¤‡è¿æ¥å†å²
  - æœ¬åœ°å­˜å‚¨
  - å¿«é€Ÿè¿æ¥

#### å…¶ä»–æ¨¡å—

- **QsoManager.js**: QSOæ—¥å¿—ç®¡ç†å™¨
  - QSOåˆ—è¡¨ç®¡ç†
  - QSOè¯¦æƒ…è·å–
  - åœ°å›¾é›†æˆ

- **SpeechTranscriber.js**: è¯­éŸ³è½¬å½•å™¨
  - SiliconFlow APIé›†æˆ
  - å®æ—¶è¯­éŸ³è¯†åˆ«
  - è½¬å½•ç»“æœå¤„ç†

- **CallsignTicker.js**: å‘¼å·æ˜¾ç¤ºç»„ä»¶
  - å‘¼å·é˜Ÿåˆ—ç®¡ç†
  - åŠ¨ç”»æ•ˆæœ
  - å‘¼å¸ç¯æ•ˆæœ

- **main.js**: ä¸»å…¥å£æ–‡ä»¶
  - åˆå§‹åŒ–æ‰€æœ‰æ¨¡å—
  - äº‹ä»¶ç»‘å®š
  - èµ„æºç®¡ç†
  - æ¸…ç†é€»è¾‘

## ğŸ¨ ä¸»é¢˜åˆ—è¡¨

1. **Default** - é»˜è®¤æ©™è‰²ä¸»é¢˜
2. **Matrix** - é»‘å®¢å¸å›½ç»¿è‰²ä¸»é¢˜
3. **Ocean** - æµ·æ´‹è“è‰²ä¸»é¢˜
4. **Sunset** - æ—¥è½ç´«è‰²ä¸»é¢˜
5. **Light** - æµ…è‰²äº®è‰²ä¸»é¢˜
6. **Pink** - ç²‰è‰²ä¸»é¢˜
7. **Purple** - ç´«è‰²ä¸»é¢˜
8. **Red** - çº¢è‰²ä¸»é¢˜
9. **Black** - é»‘è‰²ä¸»é¢˜

## ğŸ”§ é…ç½®

### ä¸»é¢˜è®¾ç½®

ä¸»é¢˜ä¼šè‡ªåŠ¨ä¿å­˜åˆ°localStorageï¼Œä¸‹æ¬¡è®¿é—®æ—¶è‡ªåŠ¨åŠ è½½ã€‚

### API Keyè®¾ç½®

éœ€è¦åœ¨è®¾ç½®é¢æ¿ä¸­é…ç½®SiliconFlow API Keyä»¥ä½¿ç”¨è¯­éŸ³è½¬å½•åŠŸèƒ½ã€‚

### è®¾å¤‡è¿æ¥

æ”¯æŒä»¥ä¸‹è¿æ¥æ–¹å¼ï¼š
1. æ‰‹åŠ¨è¾“å…¥IPåœ°å€
2. ä»å†å²è®¾å¤‡åˆ—è¡¨é€‰æ‹©
3. è‡ªåŠ¨å‘ç°å±€åŸŸç½‘è®¾å¤‡

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

å·²å®ç°çš„ä¼˜åŒ–ï¼š

1. **CSSä¼˜åŒ–**
   - ä½¿ç”¨CSSå˜é‡å®ç°ä¸»é¢˜åˆ‡æ¢
   - ç§»é™¤å…¨å±€`user-select: none`
   - ä¼˜åŒ–é€‰æ‹©å™¨æ€§èƒ½

2. **JavaScriptä¼˜åŒ–**
   - äº‹ä»¶é˜²æŠ–ï¼ˆresizeï¼‰
   - æ‰¹é‡DOMæ›´æ–°ï¼ˆDocumentFragmentï¼‰
   - è™šæ‹Ÿæ»šåŠ¨æ”¯æŒï¼ˆå°ç«™åˆ—è¡¨ï¼‰
   - èµ„æºæ¸…ç†æœºåˆ¶
   - ç§»é™¤å†…å­˜æ³„æ¼

3. **åŠ è½½ä¼˜åŒ–**
   - é™åˆ¶åˆå§‹æ¸²æŸ“å°ç«™æ•°é‡ï¼ˆ50ä¸ªï¼‰
   - æŒ‰éœ€åŠ è½½èµ„æº
   - ä»£ç åˆ†ç¦»å‡å°‘åˆå§‹åŠ è½½ä½“ç§¯

## ğŸ”’ å®‰å…¨æ€§

1. **ç§»é™¤ç¡¬ç¼–ç API Key**: ä¸å†åŒ…å«é»˜è®¤API Key
2. **XSSé˜²æŠ¤**: ä½¿ç”¨textContentè€ŒéinnerHTML
3. **è¾“å…¥éªŒè¯**: æ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½ç»è¿‡éªŒè¯
4. **å®‰å…¨é”™è¯¯å¤„ç†**: ä¸æš´éœ²æ•æ„Ÿä¿¡æ¯

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„å¯è§†åŒ–æ¨¡å¼

1. åœ¨`js/audio/renderers/`ç›®å½•åˆ›å»ºæ–°çš„æ¸²æŸ“å™¨ç±»
2. ç»§æ‰¿`BaseRenderer`ç±»
3. å®ç°`draw()`æ–¹æ³•
4. åœ¨`js/audio/Visualizer.js`ä¸­æ³¨å†Œæ–°æ¸²æŸ“å™¨

### æ·»åŠ æ–°çš„ä¸»é¢˜

1. åœ¨`css/themes.css`ä¸­æ·»åŠ æ–°çš„ä¸»é¢˜å®šä¹‰
2. åœ¨`js/main.js`ä¸­æ·»åŠ åˆ°`themes`æ•°ç»„

### æ·»åŠ æ–°çš„ç½‘ç»œåŠŸèƒ½

1. åˆ›å»ºæ–°çš„å®¢æˆ·ç«¯ç±»ç»§æ‰¿`EventEmitter`
2. å®ç°WebSocketè¿æ¥å’Œæ¶ˆæ¯å¤„ç†
3. åœ¨`js/main.js`ä¸­åˆå§‹åŒ–

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æµè§ˆå™¨å…¼å®¹æ€§**: å»ºè®®ä½¿ç”¨ç°ä»£æµè§ˆå™¨ï¼ˆChrome 80+, Firefox 75+, Safari 13+ï¼‰
2. **WebSocket**: éœ€è¦WebSocketæœåŠ¡å™¨æ”¯æŒ
3. **HTTPS**: ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨HTTPS
4. **ç§»åŠ¨ç«¯**: ä¼˜åŒ–äº†iOSå’ŒAndroidçš„è§¦æ‘¸ä½“éªŒ
5. **ç¦»çº¿æ¨¡å¼**: æš‚ä¸æ”¯æŒå®Œå…¨ç¦»çº¿æ¨¡å¼

## ğŸ› è°ƒè¯•

åœ¨æ§åˆ¶å°ä¸­å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```javascript
// æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
window.__DEBUG_LOGS__

// æ¸…ç†æ‰€æœ‰èµ„æº
window.cleanupResources()

// æ‰‹åŠ¨è§¦å‘ä¸»é¢˜åˆ‡æ¢
document.body.dataset.theme = 'matrix'
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›HAMçˆ±å¥½è€…äº¤æµä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ã€‚

## ğŸ‘¥ è´¡çŒ®è€…

- BG5EIT - Design & Development

## ğŸ“® è”ç³»æ–¹å¼

- GitHub: https://github.com/niufox/fmo-mobile-controller
- Issues: https://github.com/niufox/fmo-mobile-controller/issues

---

**æ›´æ–°æ—¥æœŸ**: 2025å¹´1æœˆ31æ—¥
**ç‰ˆæœ¬**: v4.0 (ä»£ç åˆ†ç¦»ç‰ˆæœ¬)
